/*
 * -------------------------------------------------
 *  Nextflow config file
 * -------------------------------------------------
 */

// Global default params
import java.text.SimpleDateFormat

docker {
  enabled = true
}

// Pipeline Options
params {
  outdir = "$PWD/" + "ITS-pipeline_outputs"
  publish_dir_mode = 'copy'

  // database
  unite_db = "${PWD}/databases/unite_all_eukaryotes.fasta"

  // Are reads paired-end?
  pairedEnd = false
  paired_end = false
  // Which locus?
  locus = "ITS1"
  // Quality filtering
  // keeps reads with {minPercentHighQ} % of bases above {minQuality}
  minQuality = 25
  minPercentHighQ = 90

  keep_phix = true
  max_expected_error = 3
  trunc_len = 0
  trunc_quality = 2

  // minimum read length
  minLen = 20
  min_len = 20
  // Minimum sample sizes
  minReads = 50
  min_reads = 50
  minDerep = 5
  min_derep = 5
  clusteringThresholds = "100,97"
  clustering_thresholds = "100,97"
  // Confidence confidence threshold for taxonomic assignment
  confidenceThresh = 0.5
  confidence_threshold = 0.5

  // LULU parameters for merging a parent and a daughter OTU
  skipLulu = false
  skip_lulu = false
 
  lulu_min_ratio_type = "min" // Function to compare the abundance of a parent OTU and its daughter (default: abundance=min(abundances over samples))
  lulu_min_ratio = 1 // Minimum abundance ratio between parent and daughter (across all samples)
  lulu_min_match = 97 // Identity between parent and daughter (max=100)
  lulu_min_rel_cooccurence = 1 // Proportion of the parent samples where daughter occurs (max=1)
}

profiles {
  local {
    includeConfig '../conf/container.config'
	includeConfig '../conf/local.config'
  }
  local_test {
    includeConfig '../conf/container.config'
	includeConfig '../conf/local_test.config'
  }
  hpc {
  	includeConfig '../conf/container.config'
    includeConfig '../conf/hpc.config'
  }
  hpc_test {
    includeConfig '../conf/container.config'
	includeConfig '../conf/hpc_test.config'
  }
  gcp {
    includeConfig '../conf/container.config'
    includeConfig '../conf/gcp.config'
  }
  hpc_modules {
	includeConfig '../conf/uhm_modules.config'
	includeConfig '../conf/hpc.config'
  }
  hpc_modules_test {
	includeConfig '../conf/uhm_modules.config'
	includeConfig '../conf/hpc_test.config'
  }    
}
